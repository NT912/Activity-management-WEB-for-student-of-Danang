<!DOCTYPE html>
<html lang="en">
    <%- include('../includes/head.ejs',{title: User.username}) %>

    <body class="color-theme-blue mont-font">
        <div class="main-wrapper">
            <!-- navigation top-->
            <%- include('../includes/header.ejs', { role: 'student' }) %>
            <!-- navigation top -->
    
            <!-- navigation left -->
            <%- include('../includes/nav.ejs') %>
            <!-- navigation left -->
    
            <!-- main content -->
            <div class="main-content">
                <div class="middle-sidebar-bottom">
                    <div class="middle-sidebar-left">
                        <div class="row mx-0" style="width: 100%;">
                            <div class="col-lg-12">
                                <div class="card-body d-flex align-items-center p-3 border rounded shadow-sm">
                                    <div class="avatar-container position-relative mr-3" style="width: 100px; height: 100px; border-radius: 50%; overflow: hidden;">
                                        <div class="rounded-circle" style="width: 100px; height: 100px; overflow: hidden; border: 3px solid white;">
                                            <img id="avatarImg" src="<%= User.avt %>" alt="image" class="w-100 h-100">
                                        </div>
                                        <button type="button" class="btn btn-light position-absolute camera-btn" style="bottom: 0; right: 0; padding: 5px;" onclick="document.getElementById('avatarInput').click();">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                    </div>
                                    <div class="user-info">
                                        <h4 class="fw-700 mb-1"><%= User.username %></h4>
                                        <span class="text-muted"><%= User.email %></span>
                                    </div>
                                    <div class="ml-auto">
                                        <input type="file" id="avatarInput" name="avatar" accept="image/*" class="form-control-file d-none">
                                        <button id="confirmButton" type="button" class="btn btn-success d-none" onclick="uploadAvatar()">Xác nhận</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-4 col-xxl-3 col-lg-4 pe-0">
                                <div class="card w-100 shadow-xss rounded-xxl border-0 mb-3 mt-3">
                                    <div class="card-body border-top-xs d-flex">
                                        <i class="feather-eye text-grey-500 me-3 font-lg"></i>
                                        <h4 class="fw-700 text-grey-900 font-xssss mt-0">
                                            Khoa
                                            <span class="d-block font-xssss fw-500 mt-1 lh-3 text-grey-500">
                                                <%= User.faculty %>
                                            </span>
                                        </h4>
                                    </div>
                                    <div class="card-body d-flex pt-0">
                                        <i class="feather-eye text-grey-500 me-3 font-lg"></i>
                                        <h4 class="fw-700 text-grey-900 font-xssss mt-0">
                                            Lớp
                                            <span class="d-block font-xssss fw-500 mt-1 lh-3 text-grey-500">
                                                <%= User.class %>
                                            </span>
                                        </h4>
                                    </div>
                                    <div class="card-body d-flex pt-0">
                                        <i class="feather-map-pin text-grey-500 me-3 font-lg"></i>
                                        <h4 class="fw-700 text-grey-900 font-xssss mt-1">
                                            Số điện thoại
                                            <span class="d-block font-xssss fw-500 mt-1 lh-3 text-grey-500">
                                                <% if (User.phone) { %>
                                                    <%= User.phone %>
                                                <% } else { %>
                                                    Chưa cập nhật
                                                <% } %>
                                            </span>
                                        </h4>
                                    </div>
                                    <div class="card-body d-flex pt-0">
                                        <i class="feather-mail text-grey-500 me-3 font-lg"></i>
                                        <h4 class="fw-700 text-grey-900 font-xssss mt-1">
                                            Email
                                            <span class="d-block font-xssss fw-500 mt-1 lh-3 text-grey-500">
                                                <% if (User.email) { %>
                                                    <%= User.email %>
                                                <% } else { %>
                                                    Chưa cập nhật
                                                <% } %>
                                            </span>
                                        </h4>
                                    </div>
                                    <div class="col-lg-12 d-flex justify-content-center mt-3">
                                        <a href="/user/edit" class="text-grey-900 text-center font-xssss fw-600 ls-1 rounded-xl">
                                            Sửa thông tin cá nhân
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-8 col-xxl-9 col-lg-8">
                                <div class="card-body d-block w-100 shadow-none mb-0 p-0 border-top-xs">
                                    <ul class="nav nav-tabs h55 d-flex product-info-tab border-bottom-0 ps-4" id="pills-tab" role="tablist">
                                        <li class="nav-item list-inline-item me-5">
                                            <a class="nav-link fw-700 font-xssss text-grey-500 pt-3 pb-3 ls-1 <%= active == 'registered' ? 'active' : '' %>" href="/user/profile">
                                                Đã đăng ký
                                            </a>
                                        </li>
                                        <li class="nav-item list-inline-item me-5">
                                            <a class="nav-link fw-700 font-xssss text-grey-500 pt-3 pb-3 ls-1 <%= active == 'joined' ? 'active' : '' %>" href="/user/profile?mod=joined">
                                                Đã tham gia
                                            </a>
                                        </li>
                                        <li class="nav-item list-inline-item me-5">
                                            <a class="nav-link fw-700 font-xssss text-grey-500 pt-3 pb-3 ls-1 <%= active == 'saved' ? 'active' : '' %>" href="/user/profile?mod=saved">
                                                Đã lưu
                                            </a>
                                        </li>
                                    </ul>
                                    <% if (activities.length == 0) { %>
                                        <div class="d-flex justify-content-center align-items-center" style="height: 300px;">
                                            Chưa có hoạt động nào
                                        </div>
                                    <% } else { %>
                                        <div class="d-flex flex-wrap">
                                            <% activities.forEach(activity => { %>
                                                <div class="px-2 py-2" style="width: 460px;">
                                                    <div class="card border rounded px-3 py-3">
                                                        <div class="mb-3" style="height: 200px; overflow: hidden;">
                                                            <img src="<%= activity.image %>" class="img-fluid rounded">
                                                        </div>
                                                        <h5 class="fw-500 font-xsss text-grey-500 mt-1 mb-3">
                                                            <%- activity.name %>
                                                        </h5>
                                                        <p class="fw-500 font-xssss text-grey-400 mt-1 mb-3" style="height: 50px; overflow: hidden;">
                                                            <%- activity.description %>
                                                        </p>
                                                        <a href="/activity/<%- activity.id %>/view" class="btn btn-primary">
                                                            Chi tiết
                                                        </a>
                                                    </div>
                                                </div>
                                            <% }) %>
                                        </div>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- main content --><script src="/js/action.js"></script>
        <script src="/js/plugin.js"></script>
        <script src="/js/lightbox.js"></script>
        <script src="/js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
        <% if (announc != '') {%>
            <script>
                $(function(){
                    toastr.options = {
                            "closeButton": true,
                            "debug": false,
                            "newestOnTop": false,
                            "progressBar": true,
                            "positionClass": "toast-top-right",
                            "preventDuplicates": false,
                            "onclick": null,
                            "showDuration": "300",
                            "hideDuration": "1000",
                            "timeOut": "3000",
                            "extendedTimeOut": "1000",
                            "showEasing": "swing",
                            "hideEasing": "linear",
                            "showMethod": "fadeIn",
                            "hideMethod": "fadeOut"
                        }
                    toastr.info('<%- announc %>');
                })
            </script>
            <%}%>
            </div>
        </body>

</html>